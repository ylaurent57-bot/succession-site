---
import BaseLayout from '@layouts/BaseLayout.astro';
import ArticleCard from '@components/blog/ArticleCard.astro';
import CTA from '@components/ui/CTA.astro';
import LeadForm from '@components/ui/LeadForm.astro';
import FAQ from '@components/ui/FAQ.astro';
import { getCollection } from 'astro:content';

// Récupérer les derniers articles
const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const latestPosts = allPosts
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 6);

// Pages piliers
const pillars = [
  {
    title: 'Succession',
    description: 'Tout comprendre sur l\'ouverture et le déroulement d\'une succession en France.',
    href: '/succession/',
    icon: 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',
  },
  {
    title: 'Héritage',
    description: 'Qui hérite de quoi ? Comprendre la répartition de l\'héritage entre héritiers.',
    href: '/heritage/',
    icon: 'M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z',
  },
  {
    title: 'Donation',
    description: 'Optimisez la transmission de votre patrimoine grâce aux donations.',
    href: '/donation/',
    icon: 'M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7',
  },
  {
    title: 'Testament',
    description: 'Rédigez votre testament pour organiser votre succession selon vos volontés.',
    href: '/testament/',
    icon: 'M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z',
  },
  {
    title: 'Droits de succession',
    description: 'Calculez et comprenez les droits de succession à payer au fisc.',
    href: '/droits-succession/',
    icon: 'M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z',
  },
  {
    title: 'Notaire',
    description: 'Le rôle du notaire dans la succession : frais, délais, obligations.',
    href: '/notaire/',
    icon: 'M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4',
  },
];

// FAQ pour la page d'accueil
const homeFaq = [
  {
    question: 'Combien de temps dure une succession ?',
    answer: 'Une succession dure en moyenne 6 mois à 1 an. Les délais peuvent varier selon la complexité du dossier (biens immobiliers, conflits entre héritiers, etc.). La déclaration de succession doit être déposée dans les 6 mois suivant le décès.',
  },
  {
    question: 'Peut-on faire une succession sans notaire ?',
    answer: 'Une succession peut se faire sans notaire uniquement si le défunt ne possédait pas de bien immobilier et que l\'actif successoral est inférieur à 5 000 €. Dans tous les autres cas, le recours à un notaire est obligatoire.',
  },
  {
    question: 'Comment sont calculés les droits de succession ?',
    answer: 'Les droits de succession sont calculés sur la part nette revenant à chaque héritier, après application d\'un abattement qui dépend du lien de parenté (100 000 € pour un enfant). Le taux varie de 5% à 60% selon le montant et le lien de parenté.',
  },
  {
    question: 'Qui hérite quand il n\'y a pas de testament ?',
    answer: 'En l\'absence de testament, la loi détermine les héritiers selon un ordre de priorité : les enfants et descendants, puis le conjoint survivant, les parents, frères et sœurs, et enfin les autres parents jusqu\'au 6e degré.',
  },
];
---

<BaseLayout
  description="Guide clair et structuré sur la succession en France : démarches, droits de succession, frais de notaire, testament, donation. Simulateur et FAQ."
  canonical="/"
>
  <!-- Hero Section -->
  <section class="bg-gradient-to-b from-primary-50 to-white py-16 md:py-24">
    <div class="container-wide">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-secondary-900 mb-6 text-balance">
          Succession & Héritage en France
        </h1>
        <p class="text-xl md:text-2xl text-secondary-600 mb-8">
          Démarches, droits de succession, frais de notaire, donation et testament. Informations structurées et simulateurs pour vous accompagner.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/succession/" class="btn-primary">
            Comprendre la succession
          </a>
          <a href="/outils/calculateur-droits-succession/" class="btn-outline">
            Calculer mes droits
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Piliers Section -->
  <section class="py-16 md:py-20">
    <div class="container-wide">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold text-secondary-900 mb-4">
          Guides thématiques
        </h2>
        <p class="text-lg text-secondary-600 max-w-2xl mx-auto">
          Consultez nos fiches pratiques sur chaque aspect de la succession et de la transmission de patrimoine.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {pillars.map((pillar) => (
          <a href={pillar.href} class="card group">
            <div class="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center mb-4 group-hover:bg-primary-200 transition-colors">
              <svg class="w-6 h-6 text-primary-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={pillar.icon} />
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-secondary-900 group-hover:text-primary-600 transition-colors mb-2">
              {pillar.title}
            </h3>
            <p class="text-secondary-600">
              {pillar.description}
            </p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-12">
    <div class="container-narrow">
      <CTA type="succession" />
    </div>
  </section>

  <!-- Articles récents -->
  <section class="py-16 md:py-20 bg-secondary-50">
    <div class="container-wide">
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-12">
        <div>
          <h2 class="text-3xl md:text-4xl font-bold text-secondary-900 mb-2">
            Derniers articles
          </h2>
          <p class="text-secondary-600">
            Nos conseils et actualités sur la succession
          </p>
        </div>
        <a href="/blog/" class="btn-secondary">
          Voir tous les articles
        </a>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {latestPosts.map((post, index) => (
          <ArticleCard
            title={post.data.title}
            description={post.data.description}
            href={`/blog/${post.slug}/`}
            date={post.data.date}
            category={post.data.category}
            featured={index === 0}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- Outils Section -->
  <section class="py-16 md:py-20">
    <div class="container-wide">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold text-secondary-900 mb-4">
          Outils gratuits
        </h2>
        <p class="text-lg text-secondary-600 max-w-2xl mx-auto">
          Simulez et calculez vos droits de succession en quelques clics.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
        <a href="/outils/calculateur-droits-succession/" class="card-highlight group">
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-primary-200 rounded-xl flex items-center justify-center flex-shrink-0">
              <svg class="w-6 h-6 text-primary-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-secondary-900 group-hover:text-primary-600 transition-colors mb-1">
                Calculateur de droits de succession
              </h3>
              <p class="text-secondary-600 text-sm">
                Estimez les droits de succession à payer selon votre situation familiale et le montant de l'héritage.
              </p>
            </div>
          </div>
        </a>

        <a href="/outils/simulateur-heritage/" class="card-highlight group">
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-primary-200 rounded-xl flex items-center justify-center flex-shrink-0">
              <svg class="w-6 h-6 text-primary-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-secondary-900 group-hover:text-primary-600 transition-colors mb-1">
                Simulateur de partage d'héritage
              </h3>
              <p class="text-secondary-600 text-sm">
                Calculez la répartition de l'héritage entre les différents héritiers selon la loi française.
              </p>
            </div>
          </div>
        </a>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 md:py-20 bg-secondary-50">
    <div class="container-narrow">
      <FAQ items={homeFaq} title="Questions fréquentes sur la succession" />
    </div>
  </section>

  <!-- Lead Form Section -->
  <section class="py-16 md:py-20">
    <div class="container-narrow">
      <LeadForm
        title="Recevez notre guide gratuit"
        description="Inscrivez-vous pour recevoir notre guide complet sur la succession et nos conseils d'experts."
        source="homepage"
      />
    </div>
  </section>
</BaseLayout>
